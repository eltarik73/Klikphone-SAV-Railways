import{a as m,j as e}from"./index-5YFw6LH3.js";import{r}from"./vendor-react-DMwujlca.js";import{p as H,h as R,P as K,n as Q,T as U,a as X,aM as Z,C as J,b as G,e as V}from"./vendor-icons-DnXwj2oL.js";const W={Apple:"#333333",Samsung:"#1428A0",Xiaomi:"#FF6900",Google:"#4285F4",Huawei:"#CF0A2C",Honor:"#00AAEE",Oppo:"#1A8A36",OnePlus:"#EB0028",Motorola:"#5C2D91",Nothing:"#FFFFFF",Realme:"#F5C518"},D={"Grade A":{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"},"Grade A+":{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"},"Grade B":{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"},"Grade B+":{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"},"Grade C":{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30"},Neuf:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500/30"}},_=[{value:"prix_asc",label:"Prix croissant"},{value:"prix_desc",label:"Prix decroissant"},{value:"marque",label:"Marque A-Z"},{value:"nouveautes",label:"Nouveautes"}];function Y(a){if(!a)return null;const l=new Date(a);if(isNaN(l.getTime()))return null;const t=String(l.getDate()).padStart(2,"0"),o=String(l.getMonth()+1).padStart(2,"0"),i=String(l.getHours()).padStart(2,"0"),c=String(l.getMinutes()).padStart(2,"0");return`${t}/${o} a ${i}:${c}`}function j(a){return a==null?"":Number(a).toFixed(2).replace(".",",")+" €"}function ee(a){return a?D[a]||D.Neuf:null}function g(){return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-5 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-700/50"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-7 w-16 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-4 w-24 bg-slate-700/50 rounded"})]})]})})}function se(){return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-48 bg-slate-900/80"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-3 w-16 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-5 w-3/4 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-3 w-1/2 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-7 w-24 bg-slate-700/50 rounded mt-2"}),e.jsx("div",{className:"h-3 w-32 bg-slate-700/50 rounded"})]})]})}function f({icon:a,value:l,label:t,color:o}){return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-5 transition-all hover:border-slate-600/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{backgroundColor:o+"20"},children:e.jsx(a,{className:"w-6 h-6",style:{color:o}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:l??"-"}),e.jsx("p",{className:"text-sm text-slate-400",children:t})]})]})})}function te({phone:a}){const l=a.grade||(a.type_produit==="Neuf"?"Neuf":null),t=ee(l),o=a.en_stock!==!1&&a.en_stock!==0;return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl overflow-hidden transition-all hover:border-amber-500/30 hover:shadow-lg hover:shadow-amber-500/5 group",children:[e.jsxs("div",{className:"relative h-48 bg-slate-900 flex items-center justify-center overflow-hidden",children:[a.image_url?e.jsx("img",{src:a.image_url,alt:a.modele||"Telephone",className:"h-full w-full object-contain p-4 group-hover:scale-105 transition-transform duration-300",loading:"lazy",onError:i=>{var c;i.target.style.display="none",(c=i.target.nextElementSibling)==null||c.classList.remove("hidden")}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-slate-600 ${a.image_url?"hidden":""}`,children:[e.jsx(G,{className:"w-16 h-16 mb-2"}),e.jsx("span",{className:"text-xs text-slate-600",children:"Pas d'image"})]}),t&&e.jsx("span",{className:`absolute top-3 left-3 text-[10px] font-bold px-2.5 py-1 rounded-lg ${t.bg} ${t.text} ${t.border} border backdrop-blur-sm`,children:l==="Neuf"?"NEUF":l.toUpperCase()}),e.jsx("div",{className:"absolute top-3 right-3",children:o?e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] font-semibold px-2.5 py-1 rounded-lg bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 backdrop-blur-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"}),"En stock"]}):e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] font-semibold px-2.5 py-1 rounded-lg bg-red-500/20 text-red-400 border border-red-500/30 backdrop-blur-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),"Rupture"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-500 mb-1",children:a.marque||"Marque inconnue"}),e.jsx("h3",{className:"text-sm font-bold text-white leading-tight mb-1.5 line-clamp-2",children:a.modele||"Modele inconnu"}),e.jsx("p",{className:"text-xs text-slate-400 mb-3",children:[a.stockage,a.couleur].filter(Boolean).join(" · ")||" "}),e.jsx("p",{className:"text-xl font-extrabold text-amber-500 mb-2",children:a.prix_vente!=null?j(a.prix_vente):"Prix sur demande"}),a.prix_fournisseur!=null&&e.jsxs("p",{className:"text-xs text-slate-600 line-through mb-2",children:["Fournisseur : ",j(a.prix_fournisseur)]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[e.jsx(V,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[11px]",children:"Garantie 12 mois"})]})]})]})}function ae({checked:a,onChange:l,label:t}){return e.jsxs("label",{className:"flex items-center gap-2.5 cursor-pointer select-none",children:[e.jsx("div",{onClick:()=>l(!a),className:`relative w-10 h-[22px] rounded-full transition-colors duration-200 ${a?"bg-amber-500":"bg-slate-600"}`,children:e.jsx("div",{className:`absolute top-[2px] w-[18px] h-[18px] rounded-full bg-white shadow-sm transition-transform duration-200 ${a?"translate-x-[20px]":"translate-x-[2px]"}`})}),e.jsx("span",{className:"text-sm text-slate-400",children:t})]})}function oe(){const[a,l]=r.useState([]),[t,o]=r.useState(null),[i,c]=r.useState([]),[P,E]=r.useState(!0),[M,T]=r.useState(!0),[h,F]=r.useState(!1),[b,$]=r.useState(""),[d,v]=r.useState(""),[N,q]=r.useState(""),[w,A]=r.useState(!1),[x,B]=r.useState("prix_asc"),[u,y]=r.useState(!1),S=r.useCallback(async()=>{T(!0);try{const[s,n]=await Promise.all([m.getTelephoneStats(),m.getTelephoneMarques()]);o(s),c(n||[])}catch(s){console.error("Erreur chargement stats telephones:",s)}finally{T(!1)}},[]),k=r.useCallback(async()=>{E(!0);try{const s={};d&&(s.marque=d),b&&(s.type_produit=b),w&&(s.en_stock=!0),N.trim()&&(s.search=N.trim()),x&&(s.tri=x);const n=await m.getTelephonesCatalogue(s);l(Array.isArray(n)?n:[])}catch(s){console.error("Erreur chargement telephones:",s),l([])}finally{E(!1)}},[d,b,w,N,x]);r.useEffect(()=>{S()},[S]),r.useEffect(()=>{k()},[k]);async function L(){if(!h){F(!0);try{await m.syncTelephones();let s=0;for(;s<120;){await new Promise(n=>setTimeout(n,5e3)),s++;try{if(!(await m.getSyncStatus()).running)break}catch{break}}await Promise.all([S(),k()])}catch(s){console.error("Erreur sync telephones:",s)}finally{F(!1)}}}r.useEffect(()=>{if(!u)return;function s(){y(!1)}return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[u]);const[C,O]=r.useState("");r.useEffect(()=>{const s=setTimeout(()=>{q(C)},400);return()=>clearTimeout(s)},[C]);const z=[{value:"",label:"Tous"},{value:"neuf",label:"Neufs"},{value:"occasion",label:"Occasion"}],I=_.find(s=>s.value===x)||_[0];return e.jsxs("div",{className:"min-h-screen bg-slate-900 pb-12",children:[e.jsx("div",{className:"bg-slate-900 border-b border-slate-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Tarifs Telephones"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Telephones neufs et reconditionnes — Garantie 12 mois"})]}),e.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[e.jsxs("button",{onClick:L,disabled:h,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-semibold text-white transition-all disabled:opacity-60 shadow-lg",style:{background:"linear-gradient(135deg, #F59E0B, #D97706)"},children:[h?e.jsx(H,{className:"w-4 h-4 animate-spin"}):e.jsx(R,{className:"w-4 h-4"}),h?"Synchronisation...":"Synchroniser"]}),(t==null?void 0:t.derniere_sync)&&e.jsxs("p",{className:"text-[11px] text-slate-500 mt-1.5",children:["Derniere sync : ",Y(t.derniere_sync)]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mt-6",children:M?e.jsxs(e.Fragment,{children:[e.jsx(g,{}),e.jsx(g,{}),e.jsx(g,{}),e.jsx(g,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{icon:K,value:(t==null?void 0:t.total)??0,label:"Total modeles",color:"#8B5CF6"}),e.jsx(f,{icon:Q,value:(t==null?void 0:t.en_stock)??0,label:"En stock",color:"#10B981"}),e.jsx(f,{icon:U,value:(t==null?void 0:t.neufs)??0,label:"Neufs",color:"#3B82F6"}),e.jsx(f,{icon:R,value:(t==null?void 0:t.reconditionnes)??0,label:"Reconditionnes",color:"#F97316"})]})}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:z.map(s=>e.jsx("button",{onClick:()=>$(s.value),className:`px-4 py-2 rounded-xl text-sm font-medium transition-all ${b===s.value?"bg-amber-500 text-white shadow-lg shadow-amber-500/20":"border border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,children:s.label},s.value))}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-none pb-1",children:[e.jsx("button",{onClick:()=>v(""),className:`px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all ${d===""?"bg-amber-500 text-white":"border border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,children:"Toutes marques"}),i.map(s=>{const n=W[s.marque]||"#8B5CF6",p=d===s.marque;return e.jsxs("button",{onClick:()=>v(p?"":s.marque),className:`px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all border ${p?"text-white shadow-lg":"border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,style:p?{backgroundColor:n,borderColor:n}:void 0,children:[s.marque,s.nb_en_stock!=null&&e.jsxs("span",{className:`ml-1.5 text-[10px] ${p?"opacity-75":"text-slate-500"}`,children:["(",s.nb_en_stock,")"]})]},s.marque)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(X,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Rechercher un telephone...",value:C,onChange:s=>O(s.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-slate-800/70 border border-slate-700/50 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500/50 transition-all"})]}),e.jsx(ae,{checked:w,onChange:A,label:"En stock"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),y(!u)},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-slate-800/70 border border-slate-700/50 text-sm text-slate-300 hover:border-slate-600 transition-all whitespace-nowrap",children:[e.jsx(Z,{className:"w-4 h-4 text-slate-500"}),I.label,e.jsx(J,{className:`w-4 h-4 text-slate-500 transition-transform ${u?"rotate-180":""}`})]}),u&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-slate-800 border border-slate-700 rounded-xl shadow-2xl shadow-black/40 z-30 overflow-hidden",children:_.map(s=>e.jsx("button",{onClick:n=>{n.stopPropagation(),B(s.value),y(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors ${x===s.value?"bg-amber-500/10 text-amber-400 font-medium":"text-slate-300 hover:bg-slate-700/50"}`,children:s.label},s.value))})]})]})]}),e.jsx("div",{className:"mt-8",children:P?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((s,n)=>e.jsx(se,{},n))}):a.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-slate-800/50 border border-slate-700/50 flex items-center justify-center mb-6",children:e.jsx(G,{className:"w-10 h-10 text-slate-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:"Aucun telephone trouve"}),e.jsx("p",{className:"text-sm text-slate-500 max-w-md",children:"Essayez de modifier vos filtres ou lancez une synchronisation pour importer les derniers telephones disponibles."}),e.jsx("button",{onClick:()=>{$(""),v(""),O(""),q(""),A(!1),B("prix_asc")},className:"mt-6 px-5 py-2.5 rounded-xl border border-slate-600 text-sm text-slate-400 hover:border-slate-500 hover:text-slate-300 transition-all",children:"Reinitialiser les filtres"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map((s,n)=>e.jsx(te,{phone:s},s.id||n))})}),!P&&a.length>0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-xs text-slate-500",children:[a.length," telephone",a.length>1?"s":""," affiche",a.length>1?"s":"",t!=null&&t.nb_marques?` · ${t.nb_marques} marques`:"",(t==null?void 0:t.prix_min)!=null&&(t==null?void 0:t.prix_max)!=null?` · ${j(t.prix_min)} → ${j(t.prix_max)}`:""]})})]})]})}export{oe as default};
