import{a as N,j as e}from"./index-DnT6r-aX.js";import{r as l}from"./vendor-react-DMwujlca.js";import{p as Y,h as K,P as ee,n as se,T as te,a as ae,aM as re,C as le,b as U,K as ne,J as oe,e as ie}from"./vendor-icons-DnXwj2oL.js";const de={Apple:"#333333",Samsung:"#1428A0",Xiaomi:"#FF6900",Google:"#4285F4",Huawei:"#CF0A2C",Honor:"#00AAEE",Oppo:"#1A8A36",OnePlus:"#EB0028",Motorola:"#5C2D91",Nothing:"#FFFFFF",Realme:"#F5C518"},Q={"Grade A":{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"},"Grade A+":{bg:"bg-emerald-500/20",text:"text-emerald-400",border:"border-emerald-500/30"},"Grade B":{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"},"Grade B+":{bg:"bg-yellow-500/20",text:"text-yellow-400",border:"border-yellow-500/30"},"Grade C":{bg:"bg-orange-500/20",text:"text-orange-400",border:"border-orange-500/30"},Neuf:{bg:"bg-blue-500/20",text:"text-blue-400",border:"border-blue-500/30"}},F=[{value:"prix_asc",label:"Prix croissant"},{value:"prix_desc",label:"Prix decroissant"},{value:"marque",label:"Marque A-Z"},{value:"nouveautes",label:"Nouveautes"}];function ce(o){if(!o)return null;const a=new Date(o);if(isNaN(a.getTime()))return null;const t=String(a.getDate()).padStart(2,"0"),i=String(a.getMonth()+1).padStart(2,"0"),f=String(a.getHours()).padStart(2,"0"),p=String(a.getMinutes()).padStart(2,"0");return`${t}/${i} a ${f}:${p}`}function k(o){return o==null?"":Number(o).toFixed(2).replace(".",",")+" €"}function xe(o){return o?Q[o]||Q.Neuf:null}function y(){return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-5 animate-pulse",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-700/50"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx("div",{className:"h-7 w-16 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-4 w-24 bg-slate-700/50 rounded"})]})]})})}function me(){return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-48 bg-slate-900/80"}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-3 w-16 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-5 w-3/4 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-3 w-1/2 bg-slate-700/50 rounded"}),e.jsx("div",{className:"h-7 w-24 bg-slate-700/50 rounded mt-2"}),e.jsx("div",{className:"h-3 w-32 bg-slate-700/50 rounded"})]})]})}function S({icon:o,value:a,label:t,color:i}){return e.jsx("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl p-5 transition-all hover:border-slate-600/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shrink-0",style:{backgroundColor:i+"20"},children:e.jsx(o,{className:"w-6 h-6",style:{color:i}})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:a??"-"}),e.jsx("p",{className:"text-sm text-slate-400",children:t})]})]})})}const ue=l.memo(function({phone:a}){const t=a.grade||(a.type_produit==="Neuf"?"Neuf":null),i=xe(t),f=a.en_stock!==!1&&a.en_stock!==0;return e.jsxs("div",{className:"bg-slate-800/50 border border-slate-700/50 rounded-2xl overflow-hidden transition-shadow duration-200 hover:border-amber-500/30 hover:shadow-lg hover:shadow-amber-500/5 group",children:[e.jsxs("div",{className:"relative h-48 bg-slate-900 flex items-center justify-center overflow-hidden",children:[a.image_url?e.jsx("img",{src:a.image_url,alt:a.modele||"Telephone",className:"h-full w-full object-contain p-4 group-hover:scale-105 transition-transform duration-200",loading:"lazy",onError:p=>{var j;p.target.style.display="none",(j=p.target.nextElementSibling)==null||j.classList.remove("hidden")}}):null,e.jsxs("div",{className:`flex flex-col items-center justify-center text-slate-600 ${a.image_url?"hidden":""}`,children:[e.jsx(U,{className:"w-16 h-16 mb-2"}),e.jsx("span",{className:"text-xs text-slate-600",children:"Pas d'image"})]}),i&&e.jsx("span",{className:`absolute top-3 left-3 text-[10px] font-bold px-2.5 py-1 rounded-lg ${i.bg} ${i.text} ${i.border} border backdrop-blur-sm`,children:t==="Neuf"?"NEUF":t.toUpperCase()}),e.jsx("div",{className:"absolute top-3 right-3",children:f?e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] font-semibold px-2.5 py-1 rounded-lg bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 backdrop-blur-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-400 animate-pulse"}),"En stock"]}):e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] font-semibold px-2.5 py-1 rounded-lg bg-red-500/20 text-red-400 border border-red-500/30 backdrop-blur-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-red-400"}),"Rupture"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-500 mb-1",children:a.marque||"Marque inconnue"}),e.jsx("h3",{className:"text-sm font-bold text-white leading-tight mb-1.5 line-clamp-2",children:a.modele||"Modele inconnu"}),e.jsx("p",{className:"text-xs text-slate-400 mb-3",children:[a.stockage,a.couleur].filter(Boolean).join(" · ")||" "}),e.jsx("p",{className:"text-xl font-extrabold text-amber-500 mb-2",children:a.prix_vente!=null?k(a.prix_vente):"Prix sur demande"}),a.prix_fournisseur!=null&&e.jsxs("p",{className:"text-xs text-slate-600 line-through mb-2",children:["Fournisseur : ",k(a.prix_fournisseur)]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-500",children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[11px]",children:"Garantie 12 mois"})]})]})]})});function he({checked:o,onChange:a,label:t}){return e.jsxs("label",{className:"flex items-center gap-2.5 cursor-pointer select-none",children:[e.jsx("div",{onClick:()=>a(!o),className:`relative w-10 h-[22px] rounded-full transition-colors duration-200 ${o?"bg-amber-500":"bg-slate-600"}`,children:e.jsx("div",{className:`absolute top-[2px] w-[18px] h-[18px] rounded-full bg-white shadow-sm transition-transform duration-200 ${o?"translate-x-[20px]":"translate-x-[2px]"}`})}),e.jsx("span",{className:"text-sm text-slate-400",children:t})]})}function fe(){const[o,a]=l.useState([]),[t,i]=l.useState(null),[f,p]=l.useState([]),[j,$]=l.useState(!0),[J,A]=l.useState(!0),[w,q]=l.useState(!1),[u,B]=l.useState(""),[c,C]=l.useState(""),[h,R]=l.useState(""),[b,M]=l.useState(!0),[x,O]=l.useState("prix_asc"),[v,_]=l.useState(!1),[d,g]=l.useState(1),[m,D]=l.useState(1),[G,L]=l.useState(0),X=24,P=l.useCallback(async()=>{A(!0);try{const[s,r]=await Promise.all([N.getTelephoneStats(),N.getTelephoneMarques()]);i(s),p(r||[])}catch(s){console.error("Erreur chargement stats telephones:",s)}finally{A(!1)}},[]),E=l.useCallback(async(s=d)=>{$(!0);try{const r={page:s,limit:X};c&&(r.marque=c),u&&(r.type_produit=u),b&&(r.en_stock=!0),h.trim()&&(r.search=h.trim()),x&&(r.tri=x);const n=await N.getTelephonesCatalogue(r);if(n&&n.items)a(n.items),D(n.total_pages||1),L(n.total||0);else{const H=Array.isArray(n)?n:[];a(H),D(1),L(H.length)}}catch(r){console.error("Erreur chargement telephones:",r),a([])}finally{$(!1)}},[d,c,u,b,h,x]);l.useEffect(()=>{P()},[P]);const I=l.useRef({selectedBrand:c,typeProduit:u,enStockOnly:b,searchQuery:h,sortBy:x});l.useEffect(()=>{const s=I.current;s.selectedBrand!==c||s.typeProduit!==u||s.enStockOnly!==b||s.searchQuery!==h||s.sortBy!==x?(I.current={selectedBrand:c,typeProduit:u,enStockOnly:b,searchQuery:h,sortBy:x},g(1),E(1)):E(d)},[c,u,b,h,x,d]);async function Z(){if(!w){q(!0);try{await N.syncTelephones();let s=0;for(;s<120;){await new Promise(r=>setTimeout(r,5e3)),s++;try{if(!(await N.getSyncStatus()).running)break}catch{break}}g(1),await Promise.all([P(),E(1)])}catch(s){console.error("Erreur sync telephones:",s)}finally{q(!1)}}}l.useEffect(()=>{if(!v)return;function s(){_(!1)}return document.addEventListener("click",s),()=>document.removeEventListener("click",s)},[v]);const[T,z]=l.useState("");l.useEffect(()=>{const s=setTimeout(()=>{R(T)},400);return()=>clearTimeout(s)},[T]);const V=[{value:"",label:"Tous"},{value:"neuf",label:"Neufs"},{value:"occasion",label:"Occasion"}],W=F.find(s=>s.value===x)||F[0];return e.jsxs("div",{className:"min-h-screen bg-slate-900 pb-12",children:[e.jsx("div",{className:"bg-slate-900 border-b border-slate-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-6",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Tarifs Telephones"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Telephones neufs et reconditionnes — Garantie 12 mois"})]}),e.jsxs("div",{className:"flex flex-col items-end shrink-0",children:[e.jsxs("button",{onClick:Z,disabled:w,className:"flex items-center gap-2 px-5 py-2.5 rounded-xl text-sm font-semibold text-white transition-all disabled:opacity-60 shadow-lg",style:{background:"linear-gradient(135deg, #F59E0B, #D97706)"},children:[w?e.jsx(Y,{className:"w-4 h-4 animate-spin"}):e.jsx(K,{className:"w-4 h-4"}),w?"Synchronisation...":"Synchroniser"]}),(t==null?void 0:t.derniere_sync)&&e.jsxs("p",{className:"text-[11px] text-slate-500 mt-1.5",children:["Derniere sync : ",ce(t.derniere_sync)]})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mt-6",children:J?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{}),e.jsx(y,{})]}):e.jsxs(e.Fragment,{children:[e.jsx(S,{icon:ee,value:(t==null?void 0:t.total)??0,label:"Total modeles",color:"#8B5CF6"}),e.jsx(S,{icon:se,value:(t==null?void 0:t.en_stock)??0,label:"En stock",color:"#10B981"}),e.jsx(S,{icon:te,value:(t==null?void 0:t.neufs)??0,label:"Neufs",color:"#3B82F6"}),e.jsx(S,{icon:K,value:(t==null?void 0:t.reconditionnes)??0,label:"Reconditionnes",color:"#F97316"})]})}),e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex items-center gap-2 shrink-0",children:V.map(s=>e.jsx("button",{onClick:()=>B(s.value),className:`px-4 py-2 rounded-xl text-sm font-medium transition-all ${u===s.value?"bg-amber-500 text-white shadow-lg shadow-amber-500/20":"border border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,children:s.label},s.value))}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto scrollbar-none pb-1",children:[e.jsx("button",{onClick:()=>C(""),className:`px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all ${c===""?"bg-amber-500 text-white":"border border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,children:"Toutes marques"}),f.map(s=>{const r=de[s.marque]||"#8B5CF6",n=c===s.marque;return e.jsxs("button",{onClick:()=>C(n?"":s.marque),className:`px-3 py-1.5 rounded-lg text-xs font-medium whitespace-nowrap transition-all border ${n?"text-white shadow-lg":"border-slate-600 text-slate-400 hover:border-slate-500 hover:text-slate-300"}`,style:n?{backgroundColor:r,borderColor:r}:void 0,children:[s.marque,s.nb_en_stock!=null&&e.jsxs("span",{className:`ml-1.5 text-[10px] ${n?"opacity-75":"text-slate-500"}`,children:["(",s.nb_en_stock,")"]})]},s.marque)})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ae,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsx("input",{type:"text",placeholder:"Rechercher un telephone...",value:T,onChange:s=>z(s.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-xl bg-slate-800/70 border border-slate-700/50 text-sm text-white placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-amber-500/30 focus:border-amber-500/50 transition-all"})]}),e.jsx(he,{checked:b,onChange:M,label:"En stock"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),_(!v)},className:"flex items-center gap-2 px-4 py-2.5 rounded-xl bg-slate-800/70 border border-slate-700/50 text-sm text-slate-300 hover:border-slate-600 transition-all whitespace-nowrap",children:[e.jsx(re,{className:"w-4 h-4 text-slate-500"}),W.label,e.jsx(le,{className:`w-4 h-4 text-slate-500 transition-transform ${v?"rotate-180":""}`})]}),v&&e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-slate-800 border border-slate-700 rounded-xl shadow-2xl shadow-black/40 z-30 overflow-hidden",children:F.map(s=>e.jsx("button",{onClick:r=>{r.stopPropagation(),O(s.value),_(!1)},className:`w-full text-left px-4 py-2.5 text-sm transition-colors ${x===s.value?"bg-amber-500/10 text-amber-400 font-medium":"text-slate-300 hover:bg-slate-700/50"}`,children:s.label},s.value))})]})]})]}),e.jsx("div",{className:"mt-8",children:j?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:Array.from({length:8}).map((s,r)=>e.jsx(me,{},r))}):o.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-slate-800/50 border border-slate-700/50 flex items-center justify-center mb-6",children:e.jsx(U,{className:"w-10 h-10 text-slate-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-slate-300 mb-2",children:"Aucun telephone trouve"}),e.jsx("p",{className:"text-sm text-slate-500 max-w-md",children:"Essayez de modifier vos filtres ou lancez une synchronisation pour importer les derniers telephones disponibles."}),e.jsx("button",{onClick:()=>{B(""),C(""),z(""),R(""),M(!0),O("prix_asc"),g(1)},className:"mt-6 px-5 py-2.5 rounded-xl border border-slate-600 text-sm text-slate-400 hover:border-slate-500 hover:text-slate-300 transition-all",children:"Reinitialiser les filtres"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:o.map((s,r)=>e.jsx(ue,{phone:s},s.id||r))})}),!j&&o.length>0&&e.jsxs("div",{className:"mt-8 flex flex-col items-center gap-4",children:[m>1&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>g(s=>Math.max(1,s-1)),disabled:d===1,className:"p-2 rounded-lg bg-slate-800/70 border border-slate-700/50 text-slate-400 hover:text-white hover:border-slate-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:e.jsx(ne,{className:"w-4 h-4"})}),Array.from({length:Math.min(m,7)},(s,r)=>{let n;return m<=7||d<=4?n=r+1:d>=m-3?n=m-6+r:n=d-3+r,e.jsx("button",{onClick:()=>g(n),className:`w-9 h-9 rounded-lg text-sm font-medium transition-colors ${d===n?"bg-amber-500 text-white shadow-lg shadow-amber-500/20":"bg-slate-800/70 border border-slate-700/50 text-slate-400 hover:text-white hover:border-slate-600"}`,children:n},n)}),e.jsx("button",{onClick:()=>g(s=>Math.min(m,s+1)),disabled:d===m,className:"p-2 rounded-lg bg-slate-800/70 border border-slate-700/50 text-slate-400 hover:text-white hover:border-slate-600 disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:e.jsx(oe,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:[G," telephone",G>1?"s":"",m>1?` · Page ${d}/${m}`:"",t!=null&&t.nb_marques?` · ${t.nb_marques} marques`:"",(t==null?void 0:t.prix_min)!=null&&(t==null?void 0:t.prix_max)!=null?` · ${k(t.prix_min)} → ${k(t.prix_max)}`:""]})]})]})]})}export{fe as default};
