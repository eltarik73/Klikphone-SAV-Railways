import{u as Ze,d as es,k as ss,a as as,c as i,j as e,i as G}from"./index-C8sCjayU.js";import{r}from"./vendor-react-DWtYaMjq.js";import{ap as ts,U as fe,aq as ls,o as Ce,ar as ns,f as rs,D as we,O as R,P as is,v as cs,as as ye,m as os,r as g,ag as f,G as Q,X as Se,af as ds,q as Ee,C as ms,J as us,at as xs,Q as ps,Z as _e,au as hs,F as gs,S as js,a2 as ke,av as bs}from"./vendor-icons-DOkFSV4b.js";const vs=["#3B82F6","#8B5CF6","#EC4899","#EF4444","#F97316","#EAB308","#22C55E","#06B6D4","#6366F1","#64748B"],X=[{id:1,label:"Appareil recu",message:"Bonjour {prenom}, votre {appareil} a bien ete pris en charge sous le numero {code}. Nous vous tiendrons informe de l'avancement. Klikphone 04 79 60 89 22"},{id:2,label:"Diagnostic en cours",message:"Bonjour {prenom}, le diagnostic de votre {appareil} est en cours. Nous reviendrons vers vous rapidement. Klikphone"},{id:3,label:"Devis a valider",message:"Bonjour {prenom}, le devis pour votre {appareil} est de {montant} EUR. Merci de nous confirmer votre accord. Klikphone 04 79 60 89 22"},{id:4,label:"En cours de reparation",message:"Bonjour {prenom}, la reparation de votre {appareil} est en cours. Klikphone"},{id:5,label:"Attente piece",message:"Bonjour {prenom}, nous sommes en attente d'une piece pour votre {appareil}. Nous vous previendrons des reception. Klikphone"},{id:6,label:"Appareil pret",message:"Bonjour {prenom}, votre {appareil} est pret ! Vous pouvez venir le recuperer a la boutique. Montant : {montant} EUR. Klikphone 79 Place Saint Leger, Chambery"},{id:7,label:"Commande arrivee",message:"Bonjour {prenom}, la piece commandee pour votre {appareil} est arrivee. Nous lancons la reparation. Klikphone 04 79 60 89 22"},{id:8,label:"Non reparable",message:"Bonjour {prenom}, malheureusement votre {appareil} n'est pas reparable. Vous pouvez passer recuperer votre appareil en boutique. Klikphone"},{id:9,label:"Rappel RDV",message:"Bonjour {prenom}, nous vous rappelons votre rendez-vous demain pour votre {appareil}. Klikphone 79 Place Saint Leger, Chambery"},{id:10,label:"Personnalise",message:""}];function ys(){const{user:Ns}=Ze(),t=es(),{animations:q,setAnimations:Ae}=ss(),[l,S]=r.useState({}),[Z,Ie]=r.useState([]),[b,ee]=r.useState(!1),[d,Me]=r.useState("general"),[Pe,B]=r.useState(!1),[E,se]=r.useState(null),[v,C]=r.useState({nom:"",role:"tech",couleur:"#3B82F6",actif:!0}),[De,_]=r.useState(!1),[P,F]=r.useState(""),[ae,V]=r.useState(""),[te,le]=r.useState(!1),[U,k]=r.useState([]),[ne,re]=r.useState(!1),[j,D]=r.useState({target:"accueil",old_pin:"",new_pin:""}),[ie,ce]=r.useState(!1),[m,T]=r.useState({old_password:"",new_password:"",confirm:""}),[oe,de]=r.useState(!1),[me,N]=r.useState(""),[u,p]=r.useState({}),[ue,xe]=r.useState(!1),[pe,he]=r.useState(!1),[ge,je]=r.useState(!1),[O,Te]=r.useState(""),K=r.useRef({}),H=r.useCallback(()=>{const s=K.current;return Object.keys(l).some(a=>(l[a]||"")!==(s[a]||""))},[l]);r.useEffect(()=>{const s=a=>{H()&&(a.preventDefault(),a.returnValue="")};return window.addEventListener("beforeunload",s),()=>window.removeEventListener("beforeunload",s)},[H]);const[A,Oe]=r.useState({marques:[],modeles:[]}),[be,Le]=r.useState({}),[w,z]=r.useState({categorie:"Smartphone",marque:""}),[x,L]=r.useState({categorie:"Smartphone",marque:"",modele:""}),$=["Smartphone","Tablette","PC Portable","Console","Autre"],{data:I,loading:Re}=as("config:main",async()=>{const[s,a]=await Promise.all([i.getConfig(),i.getTeam()]),n={};return Array.isArray(s)?s.forEach(o=>{n[o.cle]=o.valeur}):Object.assign(n,s),{config:n,team:a}},{tags:["config","team"],ttl:3e5});r.useEffect(()=>{I&&(S(I.config),K.current={...I.config},Ie(I.team))},[I]);const M=async()=>{try{const s=await i.getAllCatalog();Oe(s)}catch(s){console.error(s)}};r.useEffect(()=>{d==="catalog"&&M(),d==="caisse"&&i.getCaisseConfig().then(p).catch(()=>{}),d==="messages"&&i.getMessageTemplates().then(s=>{s&&s.length>0?k(s):k(X)}).catch(()=>k(X))},[d]);const y=async()=>{ee(!0);try{const s=Object.entries(l).map(([a,n])=>({cle:a,valeur:n||""}));await i.setParams(s),K.current={...l},t.success("Configuration enregistrée")}catch{t.error("Erreur sauvegarde")}finally{ee(!1)}},c=(s,a)=>{S(n=>({...n,[s]:a}))},W=()=>{C({nom:"",role:"tech",couleur:"#3B82F6",actif:!0}),se(null),B(!1)},J=async s=>{var n;const a=v.role==="manager";if(a&&!s){F(""),V(""),_(!0);return}try{E?await i.updateTeamMember(E.id,v,a?s:void 0):await i.createTeamMember(v,a?s:void 0),W(),_(!1),F(""),G("config","team"),t.success(E?"Membre mis à jour":"Membre créé")}catch(o){(n=o.message)!=null&&n.includes("Code administrateur")?V("Code administrateur incorrect"):(t.error(o.message||"Erreur"),_(!1))}},qe=s=>{se(s),C({nom:s.nom||"",role:s.role||"tech",couleur:s.couleur||"#3B82F6",actif:s.actif!==0}),B(!0)},Be=async s=>{if(confirm("Supprimer ce membre ?"))try{await i.deleteTeamMember(s),G("config","team"),t.success("Membre supprimé")}catch{t.error("Erreur suppression")}},Fe=async()=>{ce(!0);try{await i.changePin(j.target,j.old_pin,j.new_pin),D({target:j.target,old_pin:"",new_pin:""}),t.success("PIN modifié")}catch(s){t.error(s.message||"Erreur changement PIN")}finally{ce(!1)}},Ve=async()=>{if(N(""),m.new_password!==m.confirm){N("Les mots de passe ne correspondent pas");return}if(m.new_password.length<4){N("Le mot de passe doit faire au moins 4 caractères");return}de(!0);try{await i.changeAdminPassword(m.old_password,m.new_password),T({old_password:"",new_password:"",confirm:""}),t.success("Mot de passe admin modifié")}catch(s){N(s.message||"Erreur")}finally{de(!1)}},ve=async()=>{if(w.marque.trim())try{await i.addMarque(w.categorie,w.marque.trim()),z(s=>({...s,marque:""})),await M(),t.success("Marque ajoutée")}catch{t.error("Erreur")}},Ne=async()=>{if(!(!x.modele.trim()||!x.marque))try{await i.addModele(x.categorie,x.marque,x.modele.trim()),L(s=>({...s,modele:""})),await M(),t.success("Modèle ajouté")}catch{t.error("Erreur")}},Ue=async(s,a)=>{if(confirm(`Supprimer ${a} et tous ses modèles ?`))try{await i.deleteMarque(s,a),await M(),t.success("Marque supprimée")}catch{t.error("Erreur")}},Ke=async(s,a,n)=>{try{await i.deleteModele(s,a,n),await M(),t.success("Modèle supprimé")}catch{t.error("Erreur")}},He=async()=>{try{const s=await i.getBackup(),a=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),n=URL.createObjectURL(a),o=document.createElement("a");o.href=n,o.download=`klikphone_backup_${new Date().toISOString().slice(0,10)}.json`,o.click(),URL.revokeObjectURL(n),t.success("Backup téléchargé")}catch{t.error("Erreur backup")}},ze=async()=>{try{await i.exportClientsCsv(),t.success("Export CSV téléchargé")}catch{t.error("Erreur export CSV")}},$e=async()=>{try{await i.exportClientsExcel(),t.success("Export Excel téléchargé")}catch{t.error("Erreur export Excel")}},We=async s=>{var n,o;const a=(n=s.target.files)==null?void 0:n[0];if(a)try{const h=await a.text(),Y=JSON.parse(h);if(!Y.tables){t.error("Format de backup invalide");return}if(!confirm(`Restaurer le backup du ${((o=Y.backup_date)==null?void 0:o.slice(0,10))||"?"} ? Cela remplacera TOUTES les données actuelles.`))return;const Ye=await i.importBackup(Y),Ge=Object.values(Ye.imported).reduce((Qe,Xe)=>Qe+Xe,0);t.success(`Backup restauré : ${Ge} enregistrements importés`),G("config","team")}catch(h){t.error(h.message||"Erreur import backup")}finally{s.target.value=""}},Je=[{id:"general",label:"Boutique",icon:ts},{id:"team",label:"Équipe",icon:fe},{id:"catalog",label:"Catalogue",icon:ls},{id:"messages",label:"Messages",icon:Ce},{id:"notifications",label:"Notifs",icon:ns},{id:"fidelite",label:"Fidélité",icon:rs},{id:"caisse",label:"Caisse",icon:we},{id:"security",label:"Sécurité",icon:R},{id:"modules",label:"Modules",icon:is},{id:"appearance",label:"Apparence",icon:cs},{id:"backup",label:"Sauvegarde",icon:ye}];return Re?e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"w-8 h-8 border-2 border-brand-600 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"p-4 sm:p-6 lg:p-8 max-w-4xl",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900 tracking-tight",children:"Configuration"}),e.jsx("p",{className:"text-sm text-slate-500 mt-0.5",children:"Paramètres de l'application"})]})}),e.jsx("div",{className:"flex flex-wrap gap-1 mb-6",children:Je.map(({id:s,label:a,icon:n})=>e.jsxs("button",{onClick:()=>Me(s),className:`flex items-center gap-1.5 px-3 py-2 rounded-lg text-xs font-medium transition-all
              ${d===s?"bg-brand-600 text-white shadow-sm shadow-brand-600/25":"text-slate-500 hover:bg-slate-100 hover:text-slate-700"}`,children:[e.jsx(n,{className:"w-3.5 h-3.5"})," ",a]},s))}),H()&&(d==="general"||d==="notifications"||d==="fidelite")&&e.jsxs("div",{className:"flex items-center gap-3 mb-5 px-4 py-3 bg-amber-50 border border-amber-200 rounded-xl animate-in",children:[e.jsx(os,{className:"w-4 h-4 text-amber-600 shrink-0"}),e.jsx("p",{className:"text-sm text-amber-800 font-medium flex-1",children:"Modifications non sauvegardées"}),e.jsxs("button",{onClick:y,disabled:b,className:"btn-primary text-xs px-3 py-1.5",children:[b?e.jsx(g,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(f,{className:"w-3.5 h-3.5"}),"Enregistrer"]})]}),d==="general"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Informations boutique"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nom de la boutique"}),e.jsx("input",{value:l.nom_boutique||"",onChange:s=>c("nom_boutique",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Téléphone"}),e.jsx("input",{value:l.telephone||"",onChange:s=>c("telephone",s.target.value),className:"input"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"input-label",children:"Adresse"}),e.jsx("input",{value:l.adresse||"",onChange:s=>c("adresse",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email"}),e.jsx("input",{value:l.email||"",onChange:s=>c("email",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Site web"}),e.jsx("input",{value:l.site_web||"",onChange:s=>c("site_web",s.target.value),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"SIRET"}),e.jsx("input",{value:l.siret||"",onChange:s=>c("siret",s.target.value),className:"input font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"TVA"}),e.jsxs("select",{value:l.tva||"20",onChange:s=>c("tva",s.target.value),className:"input",children:[e.jsx("option",{value:"0",children:"Sans TVA"}),e.jsx("option",{value:"20",children:"20%"}),e.jsx("option",{value:"10",children:"10%"}),e.jsx("option",{value:"5.5",children:"5.5%"})]})]})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Impression"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Mentions légales (bas de ticket)"}),e.jsx("textarea",{value:l.mentions_legales||"",onChange:s=>c("mentions_legales",s.target.value),className:"input min-h-[80px] resize-none",placeholder:"Conditions générales, garantie..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Message personnalisé (ticket client)"}),e.jsx("input",{value:l.message_ticket||"",onChange:s=>c("message_ticket",s.target.value),className:"input",placeholder:"Merci de votre confiance !"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:y,disabled:b,className:"btn-primary",children:[b?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),"Enregistrer"]})})]}),d==="team"&&e.jsxs("div",{className:"space-y-5",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>{W(),B(!0)},className:"btn-primary",children:[e.jsx(Q,{className:"w-4 h-4"})," Ajouter un membre"]})}),Pe&&e.jsxs("div",{className:"card p-5 border-brand-200 animate-in",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:E?"Modifier le membre":"Nouveau membre"}),e.jsx("button",{onClick:W,className:"btn-ghost p-1.5",children:e.jsx(Se,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nom *"}),e.jsx("input",{value:v.nom,onChange:s=>C(a=>({...a,nom:s.target.value})),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Rôle"}),e.jsxs("select",{value:v.role,onChange:s=>C(a=>({...a,role:s.target.value})),className:"input",children:[e.jsx("option",{value:"tech",children:"Technicien"}),e.jsx("option",{value:"accueil",children:"Accueil"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Couleur"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:vs.map(s=>e.jsx("button",{onClick:()=>C(a=>({...a,couleur:s})),className:`w-7 h-7 rounded-lg border-2 transition-all ${v.couleur===s?"border-slate-900 scale-110":"border-transparent"}`,style:{backgroundColor:s}},s))})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:v.actif,onChange:s=>C(a=>({...a,actif:s.target.checked})),className:"rounded border-slate-300 text-brand-600 focus:ring-brand-500"}),e.jsx("span",{className:"text-sm text-slate-700",children:"Actif"})]})})]}),e.jsx("div",{className:"flex justify-end mt-4 pt-3 border-t border-slate-100",children:e.jsxs("button",{onClick:()=>J(),disabled:!v.nom,className:"btn-primary",children:[e.jsx(f,{className:"w-4 h-4"})," ",E?"Mettre à jour":"Créer"]})})]}),e.jsx("div",{className:"card overflow-hidden",children:Z.length===0?e.jsxs("div",{className:"py-12 text-center",children:[e.jsx(fe,{className:"w-8 h-8 text-slate-300 mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Aucun membre dans l'équipe"})]}):e.jsx("div",{className:"divide-y divide-slate-100",children:Z.map(s=>{var a;return e.jsxs("div",{className:"flex items-center gap-4 px-5 py-3.5",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center shrink-0",style:{backgroundColor:(s.couleur||"#3B82F6")+"20"},children:e.jsx("span",{className:"font-bold text-sm",style:{color:s.couleur||"#3B82F6"},children:(((a=s.nom)==null?void 0:a[0])||"").toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-800",children:s.nom}),e.jsx("span",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:s.couleur||"#94A3B8"}}),!s.actif&&e.jsx("span",{className:"px-1.5 py-0.5 rounded text-[10px] font-medium bg-slate-100 text-slate-400",children:"Inactif"})]}),e.jsx("p",{className:"text-xs text-slate-400 capitalize",children:s.role})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>qe(s),className:"btn-ghost p-1.5",children:e.jsx(ds,{className:"w-3.5 h-3.5"})}),e.jsx("button",{onClick:()=>Be(s.id),className:"btn-ghost p-1.5",children:e.jsx(Ee,{className:"w-3.5 h-3.5 text-red-400"})})]})]},s.id)})})}),De&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",onClick:()=>_(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm mx-4 animate-in",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(R,{className:"w-5 h-5 text-amber-500"}),e.jsx("h3",{className:"text-sm font-bold text-slate-800",children:"Code administrateur requis"})]}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Le rôle Manager donne accès aux données financières. Entrez le code administrateur pour continuer."}),e.jsx("input",{type:"password",value:P,onChange:s=>{F(s.target.value),V("")},onKeyDown:s=>s.key==="Enter"&&J(P),className:"input w-full mb-2",placeholder:"Code administrateur",autoFocus:!0}),ae&&e.jsx("p",{className:"text-xs text-red-500 mb-3",children:ae}),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx("button",{onClick:()=>_(!1),className:"btn-ghost text-sm px-3 py-1.5",children:"Annuler"}),e.jsx("button",{onClick:()=>J(P),disabled:!P,className:"btn-primary text-sm px-3 py-1.5",children:"Valider"})]})]})})]}),d==="catalog"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Ajouter une marque"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("select",{value:w.categorie,onChange:s=>z(a=>({...a,categorie:s.target.value})),className:"input w-40",children:$.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("input",{value:w.marque,onChange:s=>z(a=>({...a,marque:s.target.value})),className:"input flex-1",placeholder:"Nom de la marque",onKeyDown:s=>s.key==="Enter"&&ve()}),e.jsx("button",{onClick:ve,disabled:!w.marque.trim(),className:"btn-primary px-3",children:e.jsx(Q,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-3",children:"Ajouter un modèle"}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx("select",{value:x.categorie,onChange:s=>L(a=>({...a,categorie:s.target.value,marque:""})),className:"input w-36",children:$.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsxs("select",{value:x.marque,onChange:s=>L(a=>({...a,marque:s.target.value})),className:"input w-40",children:[e.jsx("option",{value:"",children:"— Marque —"}),[...new Set(A.marques.filter(s=>s.categorie===x.categorie).map(s=>s.marque))].map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("input",{value:x.modele,onChange:s=>L(a=>({...a,modele:s.target.value})),className:"input flex-1",placeholder:"Nom du modèle",onKeyDown:s=>s.key==="Enter"&&Ne()}),e.jsx("button",{onClick:Ne,disabled:!x.modele.trim()||!x.marque,className:"btn-primary px-3",children:e.jsx(Q,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"card overflow-hidden",children:[e.jsx("div",{className:"px-5 py-3 bg-slate-50/80 border-b border-slate-100",children:e.jsxs("span",{className:"table-header",children:["Catalogue (",A.marques.length," marques, ",A.modeles.length," modèles)"]})}),$.map(s=>{const a=[...new Set(A.marques.filter(n=>n.categorie===s).map(n=>n.marque))];return a.length===0?null:e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>Le(n=>({...n,[s]:!n[s]})),className:"w-full flex items-center gap-2 px-5 py-2.5 text-sm font-semibold text-slate-700 hover:bg-slate-50",children:[be[s]?e.jsx(ms,{className:"w-4 h-4"}):e.jsx(us,{className:"w-4 h-4"}),s," ",e.jsxs("span",{className:"text-xs text-slate-400 font-normal",children:["(",a.length,")"]})]}),be[s]&&e.jsx("div",{className:"pl-8 pr-5 pb-2",children:a.map(n=>{const o=A.modeles.filter(h=>h.categorie===s&&h.marque===n);return e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2 py-1",children:[e.jsx("span",{className:"text-xs font-semibold text-slate-600",children:n}),e.jsxs("span",{className:"text-[10px] text-slate-400",children:["(",o.length," modèles)"]}),e.jsx("button",{onClick:()=>Ue(s,n),className:"ml-auto btn-ghost p-1",children:e.jsx(Ee,{className:"w-3 h-3 text-red-400"})})]}),e.jsx("div",{className:"flex flex-wrap gap-1 ml-3",children:o.map(h=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded bg-slate-100 text-xs text-slate-600",children:[h.modele,e.jsx("button",{onClick:()=>Ke(s,n,h.modele),className:"hover:text-red-500",children:e.jsx(Se,{className:"w-3 h-3"})})]},h.modele))})]},n)})})]},s)})]})]}),d==="messages"&&e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"card p-5",children:[e.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-1 flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"})," Messages predefinis"]}),e.jsxs("p",{className:"text-xs text-slate-400 mb-4",children:["Variables disponibles : ","{prenom}"," ","{nom}"," ","{appareil}"," ","{code}"," ","{montant}"," ","{adresse}"," ","{tel_boutique}"," ","{horaires}"]}),e.jsx("div",{className:"space-y-3",children:U.map((s,a)=>e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-slate-600 mb-1 block",children:s.label}),e.jsx("textarea",{value:s.message,onChange:n=>{const o=[...U];o[a]={...o[a],message:n.target.value},k(o)},rows:2,className:"w-full px-3 py-2 rounded-lg border border-slate-200 text-xs resize-none focus:outline-none focus:ring-2 focus:ring-brand-500/20 focus:border-brand-500",placeholder:s.id===10?"Template libre (le texte sera modifiable)":"Message..."})]},s.id))}),e.jsxs("div",{className:"flex gap-2 mt-4 pt-3 border-t border-slate-100",children:[e.jsxs("button",{onClick:async()=>{re(!0);try{await i.saveMessageTemplates(U),t.success("Templates sauvegardes")}catch{t.error("Erreur sauvegarde")}finally{re(!1)}},disabled:ne,className:"btn-primary",children:[e.jsx(f,{className:"w-4 h-4"})," ",ne?"Sauvegarde...":"Sauvegarder"]}),e.jsx("button",{onClick:()=>{k(X),t.success("Templates reinitialises (sauvegarder pour appliquer)")},className:"btn-ghost",children:"Reinitialiser"})]})]})}),d==="notifications"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Discord Webhook"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"URL du webhook"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:l.DISCORD_WEBHOOK||"",onChange:s=>c("DISCORD_WEBHOOK",s.target.value),className:"input font-mono text-xs flex-1",placeholder:"https://discord.com/api/webhooks/..."}),e.jsx("button",{onClick:async()=>{le(!0);try{await y(),await i.testDiscord(),t.success("Webhook Discord fonctionnel !")}catch(s){t.error(s.message||"Erreur webhook")}finally{le(!1)}},disabled:te||!l.DISCORD_WEBHOOK,className:"btn-primary px-3 py-2 text-xs whitespace-nowrap",children:te?e.jsx(g,{className:"w-3.5 h-3.5 animate-spin"}):"Tester"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label mb-2",children:"Notifications activées"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[{key:"nouveau_ticket",label:"Nouveau ticket",desc:"Quand un ticket est créé"},{key:"changement_statut",label:"Changement de statut",desc:"Quand un statut change"},{key:"reparation_terminee",label:"Réparation terminée",desc:"Quand une réparation est finie"},{key:"accord_client",label:"Accord client",desc:"Acceptation ou refus du devis"},{key:"connexion",label:"Connexions",desc:"Connexions / déconnexions"}].map(s=>e.jsxs("label",{className:"flex items-start gap-2.5 p-2.5 rounded-lg border border-slate-100 hover:bg-slate-50 cursor-pointer transition",children:[e.jsx("input",{type:"checkbox",checked:(l[`discord_notif_${s.key}`]||"1")!=="0",onChange:a=>c(`discord_notif_${s.key}`,a.target.checked?"1":"0"),className:"rounded border-slate-300 text-brand-600 focus:ring-brand-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-700",children:s.label}),e.jsx("p",{className:"text-[10px] text-slate-400",children:s.desc})]})]},s.key))})]})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(xs,{className:"w-4 h-4 text-brand-600"})," Email"]}),e.jsxs("div",{className:"p-3 bg-brand-50 border border-brand-100 rounded-lg mb-4",children:[e.jsx("p",{className:"text-xs font-semibold text-brand-700 mb-1",children:"Resend (recommandé)"}),e.jsx("p",{className:"text-[10px] text-brand-600",children:"Créez un compte gratuit sur resend.com, récupérez votre clé API. 100 emails/jour gratuits."})]}),e.jsxs("div",{className:"space-y-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Clé API Resend"}),e.jsx("input",{value:l.RESEND_API_KEY||"re_BxiE1NX2_9qVCBVSvEAHztuFtzc8F38kr",onChange:s=>c("RESEND_API_KEY",s.target.value),className:"input font-mono text-xs",placeholder:"re_xxxxxxxx..."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email expéditeur"}),e.jsx("input",{value:l.SMTP_USER||"",onChange:s=>c("SMTP_USER",s.target.value),className:"input",placeholder:"contact@klikphone.com"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-0.5",children:"Doit correspondre au domaine vérifié sur Resend"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nom affiché"}),e.jsx("input",{value:l.SMTP_NAME||"",onChange:s=>c("SMTP_NAME",s.target.value),className:"input",placeholder:"Klikphone"})]})]})]}),e.jsxs("details",{className:"group",children:[e.jsx("summary",{className:"text-[10px] text-slate-400 cursor-pointer hover:text-slate-600 mb-3",children:"SMTP avancé (fallback si Resend non configuré)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Serveur SMTP"}),e.jsx("input",{value:l.SMTP_HOST||"",onChange:s=>c("SMTP_HOST",s.target.value),className:"input",placeholder:"ex4.mail.ovh.net"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Port"}),e.jsx("input",{value:l.SMTP_PORT||"",onChange:s=>c("SMTP_PORT",s.target.value),className:"input",placeholder:"465"})]}),e.jsxs("div",{className:"sm:col-span-2",children:[e.jsx("label",{className:"input-label",children:"Mot de passe SMTP"}),e.jsx("input",{type:"password",value:l.SMTP_PASSWORD||"",onChange:s=>c("SMTP_PASSWORD",s.target.value),className:"input"})]})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-100",children:[e.jsx("label",{className:"input-label mb-1",children:"Envoyer un email de test"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:O,onChange:s=>Te(s.target.value),className:"input flex-1",placeholder:"destinataire@email.com",type:"email"}),e.jsxs("button",{onClick:async()=>{if(!O.trim()){t.error("Saisissez une adresse email de test");return}je(!0);try{await y();const s=await i.testSmtpEmail(O.trim());s.status==="ok"?t.success(s.message||"Email de test envoyé !"):t.error(s.message||"Erreur envoi")}catch(s){t.error(s.message||"Erreur test email")}finally{je(!1)}},disabled:ge||!O.trim(),className:"btn-primary px-4 text-xs whitespace-nowrap",children:[ge?e.jsx(g,{className:"w-3.5 h-3.5 animate-spin"}):e.jsx(ps,{className:"w-3.5 h-3.5"}),"Envoyer un email de test"]})]})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Chat & Assistant IA"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Cle API Anthropic"}),e.jsx("input",{type:"password",value:l.ANTHROPIC_API_KEY||"",onChange:s=>c("ANTHROPIC_API_KEY",s.target.value),className:"input font-mono text-xs",placeholder:"sk-ant-..."}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Necessaire pour l'assistant IA. Obtenir sur console.anthropic.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Modele Claude (optionnel)"}),e.jsx("input",{value:l.ANTHROPIC_MODEL||"",onChange:s=>c("ANTHROPIC_MODEL",s.target.value),className:"input text-xs",placeholder:"claude-sonnet-4-5-20250929"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:y,disabled:b,className:"btn-primary",children:[b?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),"Enregistrer"]})})]}),d==="fidelite"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Programme de fidélité"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800",children:"Activer le programme fidélité"}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Les clients cumulent des points sur chaque réparation"})]}),e.jsx("button",{onClick:()=>c("fidelite_active",(l.fidelite_active||"1")==="1"?"0":"1"),className:`relative w-11 h-6 rounded-full transition-colors ${(l.fidelite_active||"1")==="1"?"bg-brand-600":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${(l.fidelite_active||"1")==="1"?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Points par euro dépensé"}),e.jsx("input",{type:"number",value:l.fidelite_points_par_euro||"10",onChange:s=>c("fidelite_points_par_euro",s.target.value),className:"input",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Palier film verre trempé (pts)"}),e.jsx("input",{type:"number",value:l.fidelite_palier_film||"1000",onChange:s=>c("fidelite_palier_film",s.target.value),className:"input",min:"100",step:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Palier réduction (pts)"}),e.jsx("input",{type:"number",value:l.fidelite_palier_reduction||"5000",onChange:s=>c("fidelite_palier_reduction",s.target.value),className:"input",min:"100",step:"100"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Montant réduction (€)"}),e.jsx("input",{type:"number",value:l.fidelite_montant_reduction||"10",onChange:s=>c("fidelite_montant_reduction",s.target.value),className:"input",min:"1"})]})]})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Jeu de grattage"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800",children:"Activer le jeu de grattage"}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Un ticket grattable sur la page de suivi client"})]}),e.jsx("button",{onClick:()=>c("grattage_actif",(l.grattage_actif||"1")==="1"?"0":"1"),className:`relative w-11 h-6 rounded-full transition-colors ${(l.grattage_actif||"1")==="1"?"bg-brand-600":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${(l.grattage_actif||"1")==="1"?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Fréquence de gain (1 gagnant tous les N tickets)"}),e.jsx("input",{type:"number",value:l.grattage_frequence||"10",onChange:s=>c("grattage_frequence",s.target.value),className:"input w-40",min:"2"}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-1",children:"Ex: 10 = en moyenne 1 gagnant sur 10 tickets grattés"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:y,disabled:b,className:"btn-primary",children:[b?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),"Enregistrer"]})})]}),d==="caisse"&&e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"card p-5",children:[e.jsxs("h3",{className:"font-bold text-sm text-slate-800 mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-4 h-4 text-brand-600"})," Caisse Enregistreuse"]}),e.jsxs("label",{className:"flex items-center gap-2 mb-4 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.CAISSE_ENABLED==="1",onChange:s=>p(a=>({...a,CAISSE_ENABLED:s.target.checked?"1":"0"})),className:"rounded border-slate-300 text-brand-600 focus:ring-brand-500 w-5 h-5"}),e.jsx("span",{className:"text-sm font-semibold text-slate-700",children:"Activer l'intégration Caisse Enregistreuse"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email de connexion"}),e.jsx("input",{value:u.CAISSE_LOGIN||"",onChange:s=>p(a=>({...a,CAISSE_LOGIN:s.target.value})),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Token API (APIKEY)"}),e.jsx("input",{value:u.CAISSE_APIKEY||"",onChange:s=>p(a=>({...a,CAISSE_APIKEY:s.target.value})),className:"input font-mono text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Mot de passe"}),e.jsx("input",{type:"password",value:u.CAISSE_PASSWORD||"",onChange:s=>p(a=>({...a,CAISSE_PASSWORD:s.target.value})),className:"input"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"ID Boutique (SHOPID)"}),e.jsx("input",{value:u.CAISSE_SHOPID||"",onChange:s=>p(a=>({...a,CAISSE_SHOPID:s.target.value})),className:"input font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"ID Carte bancaire"}),e.jsx("input",{value:u.CAISSE_CB_ID||"",onChange:s=>p(a=>({...a,CAISSE_CB_ID:s.target.value})),className:"input font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"ID Espèces"}),e.jsx("input",{value:u.CAISSE_ESP_ID||"",onChange:s=>p(a=>({...a,CAISSE_ESP_ID:s.target.value})),className:"input font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"ID Caisse (GENERALE)"}),e.jsx("input",{value:u.CAISSE_ID||"",onChange:s=>p(a=>({...a,CAISSE_ID:s.target.value})),className:"input font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"ID Utilisateur"}),e.jsx("input",{value:u.CAISSE_USER_ID||"",onChange:s=>p(a=>({...a,CAISSE_USER_ID:s.target.value})),className:"input font-mono"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-5",children:[e.jsxs("button",{onClick:async()=>{he(!0);try{await i.saveCaisseConfig(u);const s=await i.testCaisseConnexion();s.status==="ok"?t.success(s.message||"Connexion réussie"):t.error(s.message||"Erreur connexion")}catch(s){t.error(s.message||"Erreur test connexion")}finally{he(!1)}},disabled:pe,className:"btn-secondary",children:[pe?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(_e,{className:"w-4 h-4"}),"Tester la connexion"]}),e.jsxs("button",{onClick:async()=>{xe(!0);try{await i.saveCaisseConfig(u),t.success("Configuration caisse enregistrée")}catch{t.error("Erreur sauvegarde")}finally{xe(!1)}},disabled:ue,className:"btn-primary",children:[ue?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(f,{className:"w-4 h-4"}),"Enregistrer"]})]})]})}),d==="security"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Changer le PIN d'accès"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Espace"}),e.jsxs("select",{value:j.target,onChange:s=>D(a=>({...a,target:s.target.value})),className:"input",children:[e.jsx("option",{value:"accueil",children:"Accueil"}),e.jsx("option",{value:"tech",children:"Technicien"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Ancien PIN"}),e.jsx("input",{type:"password",value:j.old_pin,onChange:s=>D(a=>({...a,old_pin:s.target.value})),className:"input font-mono text-center tracking-widest",maxLength:4,placeholder:"····"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nouveau PIN"}),e.jsx("input",{type:"password",value:j.new_pin,onChange:s=>D(a=>({...a,new_pin:s.target.value})),className:"input font-mono text-center tracking-widest",maxLength:4,placeholder:"····"})]})]}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{onClick:Fe,disabled:ie||j.old_pin.length!==4||j.new_pin.length!==4,className:"btn-primary",children:[ie?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(hs,{className:"w-4 h-4"}),"Changer le PIN"]})})]}),e.jsxs("div",{className:"card p-5",children:[e.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-1 flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-red-500"}),"Mot de passe administrateur"]}),e.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Ce mot de passe protège l'accès à la section Administration (Reporting, Avis, Community, Config)."}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Ancien mot de passe"}),e.jsx("input",{type:"password",value:m.old_password,onChange:s=>{T(a=>({...a,old_password:s.target.value})),N("")},className:"input",placeholder:"••••••••"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nouveau mot de passe"}),e.jsx("input",{type:"password",value:m.new_password,onChange:s=>{T(a=>({...a,new_password:s.target.value})),N("")},className:"input",placeholder:"••••••••"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Confirmer"}),e.jsx("input",{type:"password",value:m.confirm,onChange:s=>{T(a=>({...a,confirm:s.target.value})),N("")},className:"input",placeholder:"••••••••"})]})]}),me&&e.jsx("p",{className:"text-xs text-red-500 mt-2",children:me}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{onClick:Ve,disabled:oe||!m.old_password||!m.new_password||!m.confirm,className:"btn-primary",children:[oe?e.jsx(g,{className:"w-4 h-4 animate-spin"}):e.jsx(R,{className:"w-4 h-4"}),"Changer le mot de passe"]})})]})]}),d==="modules"&&e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Modules optionnels"}),e.jsx("p",{className:"text-xs text-slate-400 mb-4",children:"Activez ou désactivez les modules pour afficher les pages correspondantes dans le menu latéral."}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-slate-100",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[e.jsx(gs,{className:"w-3.5 h-3.5 text-brand-500"})," Module Devis"]}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Gestion complète des devis clients avec statuts, impression et conversion en ticket"})]}),e.jsx("button",{onClick:async()=>{const s=l.MODULE_DEVIS_VISIBLE==="true"?"false":"true";S(a=>({...a,MODULE_DEVIS_VISIBLE:s}));try{await i.setParam("MODULE_DEVIS_VISIBLE",s),t.success(s==="true"?"Module Devis activé":"Module Devis désactivé")}catch{t.error("Erreur sauvegarde")}},className:`relative w-11 h-6 rounded-full transition-colors ${l.MODULE_DEVIS_VISIBLE==="true"?"bg-brand-600":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${l.MODULE_DEVIS_VISIBLE==="true"?"translate-x-5":"translate-x-0"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-t border-slate-100",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[e.jsx(_e,{className:"w-3.5 h-3.5 text-amber-500"})," Module Devis Flash"]}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Consultation rapide des prix de réparation et catalogue de téléphones en vente"})]}),e.jsx("button",{onClick:async()=>{const s=l.MODULE_DEVIS_FLASH_VISIBLE==="true"?"false":"true";S(a=>({...a,MODULE_DEVIS_FLASH_VISIBLE:s}));try{await i.setParam("MODULE_DEVIS_FLASH_VISIBLE",s),t.success(s==="true"?"Module Devis Flash activé":"Module Devis Flash désactivé")}catch{t.error("Erreur sauvegarde")}},className:`relative w-11 h-6 rounded-full transition-colors ${l.MODULE_DEVIS_FLASH_VISIBLE==="true"?"bg-amber-500":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${l.MODULE_DEVIS_FLASH_VISIBLE==="true"?"translate-x-5":"translate-x-0"}`})})]}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-4 pt-3 border-t border-slate-100",children:"Rechargez la page après activation pour voir les changements dans le menu."})]})}),d==="appearance"&&e.jsx("div",{className:"space-y-5",children:e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Apparence"}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-800",children:"Activer les animations"}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Transitions, effets de survol, apparitions progressives"})]}),e.jsx("button",{onClick:()=>Ae(!q),className:`relative w-11 h-6 rounded-full transition-colors ${q?"bg-brand-600":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${q?"translate-x-5":"translate-x-0"}`})})]}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2 pt-3 border-t border-slate-100",children:"Désactivez les animations pour améliorer la fluidité sur les appareils plus lents."}),e.jsxs("div",{className:"flex items-center justify-between py-3 mt-3 pt-3 border-t border-slate-100",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-slate-800 flex items-center gap-1.5",children:[e.jsx(js,{className:"w-3.5 h-3.5 text-slate-500"})," Autocomplétion intelligente"]}),e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:"Suggestions dans les formulaires de modification de tickets"})]}),e.jsx("button",{onClick:async()=>{const s=l.AFFICHER_AUTOCOMPLETION==="false"?"true":"false";S(a=>({...a,AFFICHER_AUTOCOMPLETION:s}));try{await i.setParam("AFFICHER_AUTOCOMPLETION",s),t.success(s==="true"?"Autocomplétion activée":"Autocomplétion désactivée")}catch{t.error("Erreur sauvegarde")}},className:`relative w-11 h-6 rounded-full transition-colors ${l.AFFICHER_AUTOCOMPLETION!=="false"?"bg-brand-600":"bg-slate-300"}`,children:e.jsx("span",{className:`absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-sm transition-transform ${l.AFFICHER_AUTOCOMPLETION!=="false"?"translate-x-5":"translate-x-0"}`})})]}),e.jsx("p",{className:"text-[11px] text-slate-400 mt-2",children:"L'apprentissage continue en arrière-plan même si l'affichage est désactivé."})]})}),d==="backup"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Export clients"}),e.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Téléchargez la liste de tous les clients (avec nombre de tickets)."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ze,className:"btn-primary",children:[e.jsx(ke,{className:"w-4 h-4"})," CSV"]}),e.jsxs("button",{onClick:$e,className:"btn-primary",children:[e.jsx(ke,{className:"w-4 h-4"})," Excel (.xlsx)"]})]})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Sauvegarde complète"}),e.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Téléchargez un backup JSON complet de la base de données (clients, tickets, config, équipe, catalogue)."}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:He,className:"btn-primary",children:[e.jsx(ye,{className:"w-4 h-4"})," Télécharger le backup (JSON)"]})})]}),e.jsxs("div",{className:"card p-5",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-4",children:"Restaurer un backup"}),e.jsx("p",{className:"text-sm text-slate-500 mb-3",children:"Importez un fichier JSON de backup pour restaurer les données. Attention : cela remplacera toutes les données actuelles."}),e.jsxs("label",{className:"btn-primary cursor-pointer inline-flex",children:[e.jsx(bs,{className:"w-4 h-4"})," Importer un backup (.json)",e.jsx("input",{type:"file",accept:".json",onChange:We,className:"hidden"})]})]})]})]})}export{ys as default};
