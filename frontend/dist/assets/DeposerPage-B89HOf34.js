import{c as o,j as e}from"./index-BOJtZnQQ.js";import{u as L,r as l}from"./vendor-react-DWtYaMjq.js";import{a8 as N,ab as V,s as X,A as y,w,x as q,G as M,ae as T,c as F,m as R,u as G}from"./vendor-icons-CUXb3u1C.js";const B=n=>/^(?:0|\+33\s?)[1-9](?:[\s.-]?\d{2}){4}$/.test(n.replace(/\s/g,"").length>=10?n:"")||/^\d{10,14}$/.test(n.replace(/[\s.-]/g,"")),U=n=>!n||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n),W=["Coordonnées","Appareil","Panne"];function O(){const n=L(),[t,p]=l.useState(0),[j,g]=l.useState(!1),[i,m]=l.useState({}),[x,A]=l.useState(null),[C,S]=l.useState([]),[_,b]=l.useState([]),[v,f]=l.useState([]),[k,E]=l.useState([]),[a,u]=l.useState({nom:"",prenom:"",telephone:"",email:"",categorie:"",marque:"",modele:"",modele_autre:"",panne:"",panne_detail:"",notes_client:""});l.useEffect(()=>{o.getCategories().then(S).catch(()=>{}),o.getPannes().then(E).catch(()=>{})},[]),l.useEffect(()=>{a.categorie&&(o.getMarques(a.categorie).then(b).catch(()=>b([])),u(s=>({...s,marque:"",modele:"",modele_autre:""})))},[a.categorie]),l.useEffect(()=>{a.categorie&&a.marque&&a.marque!=="Autre"&&(o.getModeles(a.categorie,a.marque).then(f).catch(()=>f([])),u(s=>({...s,modele:"",modele_autre:""})))},[a.marque]);const r=(s,d)=>{u(h=>({...h,[s]:d})),m(h=>({...h,[s]:void 0}))},P=()=>{const s={};return t===0&&(a.nom.trim()||(s.nom="Le nom est requis"),a.telephone.trim()?B(a.telephone)||(s.telephone="Numéro invalide (10 chiffres min.)"):s.telephone="Le téléphone est requis",a.email&&!U(a.email)&&(s.email="Email invalide")),t===1&&(a.categorie||(s.categorie="La catégorie est requise"),a.marque||(s.marque="La marque est requise"),(a.marque==="Autre"||a.modele==="Autre")&&!a.modele_autre.trim()&&(s.modele_autre="Veuillez préciser le modèle")),t===2&&(a.panne||(s.panne="Veuillez sélectionner une panne")),m(s),Object.keys(s).length===0},$=()=>t===0?a.nom&&a.telephone:t===1?a.categorie&&a.marque&&(a.marque!=="Autre"&&a.modele!=="Autre"||a.modele_autre.trim()):t===2?a.panne:!0,D=async()=>{g(!0);try{const s=await o.createDepotDistance({nom:a.nom,prenom:a.prenom,telephone:a.telephone,email:a.email,categorie:a.categorie,marque:a.marque,modele:a.marque==="Autre"||a.modele==="Autre"?"":a.modele,modele_autre:a.marque==="Autre"||a.modele==="Autre"?a.modele_autre:"",panne:a.panne,panne_detail:a.panne_detail,notes_client:a.notes_client});A(s.ticket_code)}catch(s){m({submit:s.message||"Erreur lors de l'envoi"})}finally{g(!1)}},z=()=>{P()&&(t===2?D():p(s=>s+1))},c=({field:s})=>i[s]?e.jsx("p",{className:"text-xs text-red-500 mt-1",children:i[s]}):null;return x?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-brand-50/30",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-8",children:[e.jsxs("div",{className:"card p-8 text-center animate-in",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-emerald-50 flex items-center justify-center mx-auto mb-6",children:e.jsx(N,{className:"w-10 h-10 text-emerald-500"})}),e.jsx("h2",{className:"text-2xl font-display font-bold text-slate-900 mb-2",children:"Demande enregistrée !"}),e.jsx("p",{className:"text-slate-500 mb-6",children:"Votre numéro de suivi :"}),e.jsx("div",{className:"bg-brand-50 rounded-xl py-4 px-6 mb-4 border border-brand-100",children:e.jsx("p",{className:"text-3xl font-bold font-mono text-brand-600 tracking-wider",children:x})}),e.jsxs("div",{className:"bg-indigo-50 border border-indigo-100 rounded-xl p-4 mb-6 text-left",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-800 mb-2 flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"})," Prochaines étapes"]}),e.jsxs("ol",{className:"text-sm text-indigo-700 space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:"Notre équipe va valider votre demande"}),e.jsx("li",{children:"Présentez-vous en boutique avec votre appareil"}),e.jsx("li",{children:"Votre dossier est déjà créé — accueil rapide"})]})]}),a.email&&e.jsxs("p",{className:"text-xs text-slate-400 mb-4",children:["Un email de confirmation a été envoyé à ",e.jsx("strong",{children:a.email})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>n(`/suivi?ticket=${x}`),className:"btn-primary w-full",children:[e.jsx(X,{className:"w-4 h-4"})," Suivre ma réparation"]}),e.jsxs("a",{href:"/",className:"btn-secondary w-full inline-flex items-center justify-center gap-2",children:[e.jsx(y,{className:"w-4 h-4"})," Retour à l'accueil"]})]})]}),e.jsxs("div",{className:"mt-6 card p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600",children:[e.jsx(w,{className:"w-4 h-4 text-brand-600 shrink-0"}),e.jsx("span",{children:"79 Place Saint Léger, Chambéry"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-600 mt-2",children:[e.jsx(q,{className:"w-4 h-4 text-brand-600 shrink-0"}),e.jsx("span",{children:"04 79 60 89 22"})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-indigo-50 via-white to-brand-50/30",children:e.jsxs("div",{className:"max-w-lg mx-auto px-4 py-8",children:[e.jsxs("div",{className:"text-center mb-8 animate-in",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-indigo-600 flex items-center justify-center mx-auto mb-4 shadow-lg shadow-indigo-600/20",children:e.jsx(M,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-2xl font-display font-bold text-slate-900",children:"Dépôt à distance"}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Pré-enregistrez votre appareil en ligne"})]}),e.jsx("div",{className:"flex items-center gap-1 mb-8",children:W.map((s,d)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center",children:[e.jsx("div",{className:`w-full h-2 rounded-full transition-all duration-500 ${d<t?"bg-indigo-500":d===t?"bg-indigo-400":"bg-slate-200"}`}),e.jsx("p",{className:`text-xs font-medium mt-1.5 ${d<=t?"text-indigo-600":"text-slate-400"}`,children:s})]},d))}),t===0&&e.jsxs("div",{className:"card p-6 space-y-4 animate-in",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-sky-50 flex items-center justify-center",children:e.jsx(T,{className:"w-5 h-5 text-sky-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Vos coordonnées"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Pour vous recontacter"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Nom *"}),e.jsx("input",{value:a.nom,onChange:s=>r("nom",s.target.value),className:`input ${i.nom?"border-red-300":""}`,placeholder:"Dupont"}),e.jsx(c,{field:"nom"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Prénom"}),e.jsx("input",{value:a.prenom,onChange:s=>r("prenom",s.target.value),className:"input",placeholder:"Jean"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Téléphone *"}),e.jsx("input",{type:"tel",value:a.telephone,onChange:s=>r("telephone",s.target.value),className:`input ${i.telephone?"border-red-300":""}`,placeholder:"06 XX XX XX XX"}),e.jsx(c,{field:"telephone"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Email"}),e.jsx("input",{type:"email",value:a.email,onChange:s=>r("email",s.target.value),className:`input ${i.email?"border-red-300":""}`,placeholder:"pour recevoir les notifications"}),e.jsx(c,{field:"email"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Recommandé pour recevoir les mises à jour de votre réparation"})]})]}),t===1&&e.jsxs("div",{className:"card p-6 space-y-4 animate-in",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-brand-50 flex items-center justify-center",children:e.jsx(F,{className:"w-5 h-5 text-brand-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Votre appareil"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Type, marque et modèle"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Catégorie *"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:C.filter(s=>s!=="Commande").map(s=>e.jsx("button",{onClick:()=>r("categorie",s),className:`p-3 rounded-xl text-sm font-medium border-2 transition-all text-left
                      ${a.categorie===s?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 hover:border-slate-300 text-slate-700"}`,children:s},s))}),e.jsx(c,{field:"categorie"})]}),a.categorie&&e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Marque *"}),e.jsxs("select",{value:a.marque,onChange:s=>r("marque",s.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Sélectionner..."}),_.map(s=>e.jsx("option",{value:s,children:s},s)),e.jsx("option",{value:"Autre",children:"Autre"})]}),e.jsx(c,{field:"marque"})]}),a.marque&&a.marque!=="Autre"&&v.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Modèle"}),e.jsxs("select",{value:a.modele,onChange:s=>r("modele",s.target.value),className:"input",children:[e.jsx("option",{value:"",children:"Sélectionner..."}),v.map(s=>e.jsx("option",{value:s,children:s},s)),e.jsx("option",{value:"Autre",children:"Autre"})]})]}),(a.marque==="Autre"||a.modele==="Autre")&&e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Préciser marque / modèle *"}),e.jsx("input",{value:a.modele_autre,onChange:s=>r("modele_autre",s.target.value),className:`input ${i.modele_autre?"border-red-300":""}`,placeholder:"Ex: Samsung Galaxy S24"}),e.jsx(c,{field:"modele_autre"})]})]}),t===2&&e.jsxs("div",{className:"card p-6 space-y-4 animate-in",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-amber-50 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900",children:"Le problème"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Décrivez la panne"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Type de panne *"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.map(s=>e.jsx("button",{onClick:()=>r("panne",s),className:`p-3 rounded-xl text-sm font-medium border-2 transition-all text-left
                      ${a.panne===s?"border-brand-500 bg-brand-50 text-brand-700":"border-slate-200 hover:border-slate-300 text-slate-700"}`,children:s},s))}),e.jsx(c,{field:"panne"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Détails"}),e.jsx("textarea",{value:a.panne_detail,onChange:s=>r("panne_detail",s.target.value),className:"input min-h-[80px] resize-none",placeholder:"Décrivez plus précisément le problème..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"input-label",children:"Notes"}),e.jsx("textarea",{value:a.notes_client,onChange:s=>r("notes_client",s.target.value),className:"input min-h-[60px] resize-none",placeholder:"Informations complémentaires (accessoires, état cosmétique...)"})]}),i.submit&&e.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm text-red-700",children:i.submit})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsxs("button",{onClick:()=>t===0?n("/"):p(s=>s-1),className:"btn-secondary flex-1 py-3",children:[e.jsx(y,{className:"w-4 h-4"})," ",t===0?"Accueil":"Retour"]}),e.jsx("button",{onClick:z,disabled:j||!$(),className:`flex-[2] py-3 ${t===2?"btn-primary bg-emerald-600 hover:bg-emerald-700":"btn-primary"}`,children:j?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Envoi..."]}):t===2?e.jsxs(e.Fragment,{children:["Envoyer ma demande ",e.jsx(N,{className:"w-4 h-4"})]}):e.jsxs(e.Fragment,{children:["Suivant ",e.jsx(G,{className:"w-4 h-4"})]})})]}),e.jsxs("div",{className:"mt-8 card p-4 bg-slate-50",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsx(w,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{children:"79 Place Saint Léger, Chambéry"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500 mt-1.5",children:[e.jsx(q,{className:"w-4 h-4 shrink-0"}),e.jsx("span",{children:"04 79 60 89 22"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("div",{style:{textAlign:"center",padding:"12px 0",fontSize:10,color:"#A1A1AA"},children:["Propulsé par"," ",e.jsxs("span",{style:{fontWeight:800,fontSize:11},children:[e.jsx("span",{style:{color:"#7C3AED"},children:"Tk"}),e.jsx("span",{style:{color:"#18181B"},children:"S"}),e.jsx("span",{style:{color:"#EC4899"},children:"∞"}),e.jsx("span",{style:{color:"#18181B"},children:"26"})]})," ","— une solution"," ",e.jsx("span",{style:{fontWeight:700,color:"#7C3AED"},children:"Klik&Dev"})]})})]})})}export{O as default};
