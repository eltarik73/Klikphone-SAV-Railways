import{j as e,a as u}from"./index-5YFw6LH3.js";import{r}from"./vendor-react-DMwujlca.js";import{m as ke,an as Ae,ao as Se,ap as Ce,aq as Be,ar as ce,U as Le,i as De,x as _e,as as Te,v as ze}from"./vendor-icons-DnXwj2oL.js";import{R as v,B as D,C as S,X as C,Y as B,T as N,L as ne,a as _,b as le,P as Ee,c as Re,d as Pe,e as re}from"./vendor-charts-DNuyOzTe.js";const L=["#7C3AED","#3B82F6","#10B981","#F59E0B","#EF4444","#EC4899","#06B6D4","#8B5CF6","#F97316","#6366F1"],ie="#7C3AED",Ke="#3B82F6",M="#10B981",de="#F59E0B",Oe=[{label:"7j",value:7},{label:"14j",value:14},{label:"30j",value:30}],Fe=[{label:"Aujourd'hui",value:"today"},{label:"7 jours",value:"7d"},{label:"14 jours",value:"14d"},{label:"1 mois",value:"30d"},{label:"3 mois",value:"90d"},{label:"12 mois",value:"365d"},{label:"Personnalisé",value:"custom"}],$="kp_admin_auth";function w(a){return a==null?"0,00 €":Number(a).toLocaleString("fr-FR",{minimumFractionDigits:2})+" €"}function oe(a){if(!a&&a!==0)return"—";const l=Math.floor(a),i=Math.round((a-l)*60);return l===0?`${i}min`:`${l}h ${i}min`}function j(a){return a.toISOString().split("T")[0]}function I(a,l,i){const n=new Date,o=j(n);switch(a){case"today":return{date_start:o,date_end:o};case"7d":return{date_start:j(new Date(n-7*864e5)),date_end:o};case"14d":return{date_start:j(new Date(n-14*864e5)),date_end:o};case"30d":return{date_start:j(new Date(n-30*864e5)),date_end:o};case"90d":return{date_start:j(new Date(n-90*864e5)),date_end:o};case"365d":return{date_start:j(new Date(n-365*864e5)),date_end:o};case"custom":return{date_start:l||o,date_end:i||o};default:return{date_start:j(new Date(n-30*864e5)),date_end:o}}}function T({active:a,payload:l,label:i}){return!a||!l||!l.length?null:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 shadow-xl text-xs",children:[e.jsx("p",{className:"text-slate-400 mb-1 font-medium",children:i}),l.map((n,o)=>e.jsxs("p",{className:"font-semibold",style:{color:n.color||n.fill||"#fff"},children:[n.name,": ",typeof n.value=="number"&&n.value%1!==0?n.value.toFixed(1):n.value]},o))]})}function Ie(){return e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"w-8 h-8 border-2 border-violet-500 border-t-transparent rounded-full animate-spin"})})}function h({text:a}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-500",children:[e.jsx(ce,{className:"w-8 h-8 text-slate-600 mb-2"}),e.jsx("p",{className:"text-sm",children:a||"Aucune donnée disponible"})]})}function p({title:a,children:l,className:i=""}){return e.jsxs("div",{className:`bg-slate-800 rounded-xl border border-slate-700/50 p-5 ${i}`,children:[e.jsx("h3",{className:"text-sm font-semibold text-white mb-4",children:a}),l]})}function Me({taux:a,envoyes:l,acceptes:i}){const o=Math.PI*70,d=a/100*o,x=a>=70?M:a>=40?de:"#EF4444";return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("svg",{width:"160",height:"100",viewBox:"0 0 160 100",children:[e.jsx("path",{d:"M 10 90 A 70 70 0 0 1 150 90",fill:"none",stroke:"#334155",strokeWidth:"10",strokeLinecap:"round"}),e.jsx("path",{d:"M 10 90 A 70 70 0 0 1 150 90",fill:"none",stroke:x,strokeWidth:"10",strokeLinecap:"round",strokeDasharray:`${d} ${o}`}),e.jsxs("text",{x:"80",y:"75",textAnchor:"middle",fill:"white",fontSize:"28",fontWeight:"bold",children:[a,"%"]})]}),e.jsxs("div",{className:"flex gap-6 mt-3 text-xs text-slate-400",children:[e.jsxs("span",{children:["Envoyés : ",e.jsx("strong",{className:"text-white",children:l})]}),e.jsxs("span",{children:["Acceptés : ",e.jsx("strong",{className:"text-emerald-400",children:i})]})]})]})}function $e({period:a,setPeriod:l,customStart:i,setCustomStart:n,customEnd:o,setCustomEnd:d}){return e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx("div",{className:"flex bg-slate-800 rounded-lg p-0.5 border border-slate-700/50 flex-wrap",children:Fe.map(({label:x,value:m})=>e.jsx("button",{onClick:()=>l(m),className:`px-2.5 py-1.5 rounded-md text-[11px] font-medium transition-all whitespace-nowrap ${a===m?"bg-violet-600 text-white shadow-sm":"text-slate-400 hover:text-white"}`,children:x},m))}),a==="custom"&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:i,onChange:x=>n(x.target.value),className:"px-2.5 py-1.5 rounded-lg bg-slate-800 border border-slate-700 text-white text-xs focus:outline-none focus:ring-2 focus:ring-violet-500/40"}),e.jsx("span",{className:"text-slate-500 text-xs",children:"→"}),e.jsx("input",{type:"date",value:o,onChange:x=>d(x.target.value),className:"px-2.5 py-1.5 rounded-lg bg-slate-800 border border-slate-700 text-white text-xs focus:outline-none focus:ring-2 focus:ring-violet-500/40"})]})]})}function qe({onLogin:a}){const[l,i]=r.useState(""),[n,o]=r.useState(""),[d,x]=r.useState(""),[m,z]=r.useState(!1),b=async y=>{if(y.preventDefault(),!(!l||!n)){x(""),z(!0);try{const c=await u.adminLogin(l,n);if(c.success||c.token){const E={token:c.token,ts:Date.now()};localStorage.setItem($,JSON.stringify(E)),a(E)}else x("Identifiants incorrects")}catch(c){x(c.message||"Erreur de connexion")}finally{z(!1)}}};return e.jsx("div",{className:"min-h-screen bg-slate-900 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-sm",children:[e.jsxs("div",{className:"bg-slate-800 rounded-2xl border border-slate-700/50 shadow-2xl p-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-14 h-14 rounded-xl bg-violet-600/20 flex items-center justify-center",children:e.jsx(ke,{className:"w-7 h-7 text-violet-400"})})}),e.jsx("h1",{className:"text-xl font-display font-bold text-white text-center mb-1",children:"Administration"}),e.jsx("p",{className:"text-sm text-slate-400 text-center mb-8",children:"Accès réservé aux administrateurs"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1.5",children:"Identifiant"}),e.jsx("input",{type:"text",value:l,onChange:y=>i(y.target.value),className:"w-full px-3.5 py-2.5 rounded-lg bg-slate-900 border border-slate-700 text-white text-sm placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500/40 focus:border-violet-500 transition-all",placeholder:"Votre identifiant",autoComplete:"username"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-slate-400 mb-1.5",children:"Mot de passe"}),e.jsx("input",{type:"password",value:n,onChange:y=>o(y.target.value),className:"w-full px-3.5 py-2.5 rounded-lg bg-slate-900 border border-slate-700 text-white text-sm placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-violet-500/40 focus:border-violet-500 transition-all",placeholder:"••••••••",autoComplete:"current-password"})]}),d&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg px-3 py-2 text-sm text-red-400 text-center",children:d}),e.jsx("button",{type:"submit",disabled:m||!l||!n,className:"w-full py-2.5 rounded-lg bg-violet-600 hover:bg-violet-500 disabled:opacity-50 disabled:cursor-not-allowed text-white text-sm font-semibold shadow-lg shadow-violet-600/25 transition-all",children:m?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"})," Connexion..."]}):"Se connecter"})]})]}),e.jsx("p",{className:"text-center text-xs text-slate-600 mt-6",children:"Klikphone SAV — Administration"})]})})}function He({onLogout:a}){var Q;const[l,i]=r.useState(!0),[n,o]=r.useState(7),[d,x]=r.useState("30d"),[m,z]=r.useState(j(new Date(Date.now()-30*864e5))),[b,y]=r.useState(j(new Date)),[c,E]=r.useState(null),[k,q]=r.useState(null),[R,xe]=r.useState([]),[H,me]=r.useState([]),[P,ue]=r.useState([]),[U,he]=r.useState([]),[J,pe]=r.useState([]),[F,fe]=r.useState([]),[K,je]=r.useState(null),[V,be]=r.useState([]),[W,ge]=r.useState([]),[Y,G]=r.useState("");I(d,m,b);const X=r.useCallback(async()=>{i(!0),G("");const t=I(d,m,b);try{const[s,f,g,A,O,Z,ee,te,we,se,ae]=await Promise.all([u.getAdminOverview(t).catch(()=>null),u.getAdminReparationsParTech(n,t).catch(()=>null),u.getAdminAffluenceHeure(t).catch(()=>[]),u.getAdminAffluenceJour(t).catch(()=>[]),u.getAdminRepartitionMarques(t).catch(()=>[]),u.getAdminRepartitionPannes(t).catch(()=>[]),u.getAdminEvolutionCA(t).catch(()=>[]),u.getAdminTempsReparation(t).catch(()=>[]),u.getAdminTauxConversion(t).catch(()=>null),u.getAdminTopClients(t).catch(()=>[]),u.getAdminPerformanceTech().catch(()=>[])]);E(s),q(f),xe(Array.isArray(g)?g:[]),me(Array.isArray(A)?A:[]),ue(Array.isArray(O)?O:[]),he(Array.isArray(Z)?Z:[]),pe(Array.isArray(ee)?ee:[]),fe(Array.isArray(te)?te:[]),je(we),be(Array.isArray(se)?se:[]),ge(Array.isArray(ae)?ae:[])}catch(s){G("Erreur lors du chargement des données"),console.error(s)}finally{i(!1)}},[d,m,b,n]);r.useEffect(()=>{X()},[X]);const ye=r.useCallback(async t=>{o(t);try{const s=I(d,m,b),f=await u.getAdminReparationsParTech(t,s);q(f)}catch{}},[d,m,b]),ve=c?[{label:"CA du jour",value:w(c.ca_jour),sub:"payés",icon:Ae,color:"text-emerald-400",bg:"bg-emerald-500/10"},{label:"CA du mois",value:w(c.ca_mois),sub:"payés",icon:Se,color:"text-violet-400",bg:"bg-violet-500/10"},{label:"CA potentiel",value:w(c.ca_potentiel),sub:"devis en cours",icon:Ce,color:"text-amber-400",bg:"bg-amber-500/10"},{label:"Répar. du jour",value:c.reparations_jour,sub:"terminées",icon:Be,color:"text-blue-400",bg:"bg-blue-500/10"},{label:"Répar. du mois",value:c.reparations_mois,sub:"clôturées",icon:ce,color:"text-cyan-400",bg:"bg-cyan-500/10"},{label:"Ticket moyen",value:w(c.ticket_moyen),sub:"CA/réparation",icon:Le,color:"text-pink-400",bg:"bg-pink-500/10"}]:[],Ne=R.reduce((t,s)=>s.moyenne>((t==null?void 0:t.moyenne)||0)?s:t,null);return e.jsxs("div",{className:"min-h-screen bg-slate-900",children:[e.jsx("div",{className:"sticky top-0 z-30 bg-slate-900/95 backdrop-blur-sm border-b border-slate-800",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-display font-bold text-white tracking-tight",children:"Administration"}),e.jsx("p",{className:"text-sm text-slate-400 mt-0.5",children:"Tableau de bord analytique"})]}),e.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-medium text-slate-400 hover:text-white hover:bg-slate-800 border border-slate-700/50 transition-all",children:[e.jsx(De,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"hidden sm:inline",children:"Déconnexion"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4 text-slate-500 shrink-0"}),e.jsx($e,{period:d,setPeriod:x,customStart:m,setCustomStart:z,customEnd:b,setCustomEnd:y})]})]})})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[Y&&e.jsx("div",{className:"bg-red-500/10 border border-red-500/20 rounded-lg px-4 py-3 text-sm text-red-400",children:Y}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Vue d'ensemble"}),l&&!c?e.jsx(Ie,{}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:ve.map(({label:t,value:s,sub:f,icon:g,color:A,bg:O})=>e.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700/50 p-4 hover:border-slate-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-[10px] font-medium text-slate-500 uppercase tracking-wider",children:t}),e.jsx("div",{className:`w-8 h-8 rounded-lg ${O} flex items-center justify-center`,children:e.jsx(g,{className:`w-4 h-4 ${A}`})})]}),e.jsx("p",{className:"text-xl font-bold text-white tracking-tight",children:s}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-0.5",children:f})]},t))})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider",children:"Réparations par technicien"}),e.jsx("div",{className:"flex bg-slate-800 rounded-lg p-0.5 border border-slate-700/50",children:Oe.map(({label:t,value:s})=>e.jsx("button",{onClick:()=>ye(s),className:`px-3 py-1 rounded-md text-xs font-medium transition-all ${n===s?"bg-violet-600 text-white shadow-sm":"text-slate-400 hover:text-white"}`,children:t},s))})]}),e.jsx(p,{title:`Réparations par technicien (${n} derniers jours)`,children:(Q=k==null?void 0:k.data)!=null&&Q.length?e.jsx(v,{width:"100%",height:300,children:e.jsxs(D,{data:k.data,children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(C,{dataKey:"jour",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Jour",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},allowDecimals:!1,label:{value:"Réparations",angle:-90,position:"insideLeft",style:{fill:"#64748B",fontSize:11}}}),e.jsx(N,{content:e.jsx(T,{})}),e.jsx(ne,{wrapperStyle:{fontSize:11,color:"#94A3B8"}}),k.techniciens.map((t,s)=>e.jsx(_,{dataKey:t.nom,stackId:"a",fill:t.couleur||L[s%L.length],radius:s===k.techniciens.length-1?[4,4,0,0]:[0,0,0,0]},t.nom))]})}):e.jsx(h,{text:"Aucune réparation sur la période"})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Affluence"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(p,{title:"Affluence par heure",children:R.length?e.jsx(v,{width:"100%",height:280,children:e.jsxs(D,{data:R,children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(C,{dataKey:"heure",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Heure",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Dépôts moyens",angle:-90,position:"insideLeft",style:{fill:"#64748B",fontSize:11}}}),e.jsx(N,{content:e.jsx(T,{})}),e.jsx(_,{dataKey:"moyenne",name:"Moyenne/jour",radius:[4,4,0,0],maxBarSize:28,children:R.map((t,s)=>e.jsx(le,{fill:t===Ne?"#A78BFA":ie},s))})]})}):e.jsx(h,{text:"Aucune donnée d'affluence"})}),e.jsx(p,{title:"Affluence par jour de la semaine",children:H.length?e.jsx(v,{width:"100%",height:280,children:e.jsxs(D,{data:H,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(C,{type:"number",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Dépôts moyens",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{type:"category",dataKey:"jour",tick:{fontSize:11,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},width:80}),e.jsx(N,{content:e.jsx(T,{})}),e.jsx(_,{dataKey:"moyenne",name:"Moyenne/semaine",fill:M,radius:[0,4,4,0],maxBarSize:24})]})}):e.jsx(h,{text:"Aucune donnée d'affluence"})})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Analyses"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx(p,{title:"Répartition par marque",children:P.length?e.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-4",children:[e.jsx(v,{width:"100%",height:250,children:e.jsxs(Ee,{children:[e.jsx(Re,{data:P,cx:"50%",cy:"50%",innerRadius:55,outerRadius:90,paddingAngle:3,dataKey:"count",nameKey:"marque",children:P.map((t,s)=>e.jsx(le,{fill:L[s%L.length]},s))}),e.jsx(N,{content:e.jsx(T,{})})]})}),e.jsx("div",{className:"flex flex-wrap gap-x-4 gap-y-2 justify-center lg:flex-col lg:gap-y-1.5",children:P.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full shrink-0",style:{backgroundColor:L[s%L.length]}}),e.jsx("span",{className:"text-xs text-slate-300",children:t.marque}),e.jsxs("span",{className:"text-[10px] text-slate-500",children:[t.pct,"% (",t.count,")"]})]},s))})]}):e.jsx(h,{})}),e.jsx(p,{title:"Top 10 types de panne",children:U.length?e.jsx(v,{width:"100%",height:300,children:e.jsxs(D,{data:U,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(C,{type:"number",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},allowDecimals:!1,label:{value:"Nombre de tickets",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{type:"category",dataKey:"panne",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},width:130}),e.jsx(N,{content:e.jsx(T,{})}),e.jsx(_,{dataKey:"count",name:"Tickets",fill:Ke,radius:[0,4,4,0],maxBarSize:20})]})}):e.jsx(h,{})})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Évolution du chiffre d'affaires"}),e.jsx(p,{title:"CA encaissé vs CA potentiel (12 derniers mois)",children:J.length?e.jsx(v,{width:"100%",height:320,children:e.jsxs(Pe,{data:J,children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(C,{dataKey:"mois",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Mois",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},tickFormatter:t=>`${t}€`,label:{value:"Chiffre d'affaires (€)",angle:-90,position:"insideLeft",offset:10,style:{fill:"#64748B",fontSize:11}}}),e.jsx(N,{content:({active:t,payload:s,label:f})=>!t||!s?null:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 shadow-xl text-xs",children:[e.jsx("p",{className:"text-slate-400 mb-1 font-medium",children:f}),s.map((g,A)=>e.jsxs("p",{style:{color:g.color},className:"font-semibold",children:[g.name," : ",w(g.value)]},A))]})}),e.jsx(ne,{wrapperStyle:{fontSize:11}}),e.jsx(re,{type:"monotone",dataKey:"ca_encaisse",name:"CA encaissé",stroke:M,strokeWidth:2.5,dot:{r:3},activeDot:{r:5}}),e.jsx(re,{type:"monotone",dataKey:"ca_potentiel",name:"CA potentiel",stroke:de,strokeWidth:2.5,dot:{r:3},activeDot:{r:5},strokeDasharray:"5 5"})]})}):e.jsx(h,{text:"Aucune donnée d'évolution"})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Temps moyen de réparation"}),e.jsx(p,{title:"Durée moyenne par type de panne",children:F.length?e.jsx(v,{width:"100%",height:Math.max(250,F.length*35),children:e.jsxs(D,{data:F,layout:"vertical",children:[e.jsx(S,{strokeDasharray:"3 3",stroke:"#334155",horizontal:!1}),e.jsx(C,{type:"number",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},label:{value:"Heures",position:"insideBottom",offset:-5,style:{fill:"#64748B",fontSize:11}}}),e.jsx(B,{type:"category",dataKey:"panne",tick:{fontSize:10,fill:"#94A3B8"},tickLine:!1,axisLine:{stroke:"#334155"},width:130}),e.jsx(N,{content:({active:t,payload:s,label:f})=>!t||!(s!=null&&s.length)?null:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg px-3 py-2 shadow-xl text-xs",children:[e.jsx("p",{className:"text-slate-400 mb-1 font-medium",children:f}),e.jsx("p",{className:"text-violet-400 font-semibold",children:oe(s[0].value)}),e.jsxs("p",{className:"text-slate-500",children:[s[0].payload.nb," réparations"]})]})}),e.jsx(_,{dataKey:"temps_moyen_heures",name:"Temps moyen",fill:ie,radius:[0,4,4,0],maxBarSize:20})]})}):e.jsx(h,{text:"Pas assez de données"})})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Performance"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[e.jsx(p,{title:"Taux de conversion devis",children:K?e.jsx(Me,{taux:K.taux,envoyes:K.devis_envoyes,acceptes:K.devis_acceptes}):e.jsx(h,{text:"Aucune donnée"})}),e.jsx(p,{title:"Performance techniciens",className:"lg:col-span-2",children:W.length?e.jsx("div",{className:"overflow-x-auto -mx-5 px-5",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Technicien"}),e.jsx("th",{className:"text-center text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Répar."}),e.jsx("th",{className:"text-center text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Temps moy."}),e.jsx("th",{className:"text-right text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"CA"})]})}),e.jsx("tbody",{children:W.map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-700/30 hover:bg-slate-700/20 transition-colors",children:[e.jsx("td",{className:"py-2.5",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-violet-500/20 flex items-center justify-center",children:e.jsx("span",{className:"text-[10px] font-bold text-violet-400",children:(t.technicien||"?")[0].toUpperCase()})}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.technicien})]})}),e.jsx("td",{className:"py-2.5 text-center text-sm text-slate-300",children:t.reparations}),e.jsx("td",{className:"py-2.5 text-center text-sm text-slate-300",children:oe((t.temps_moyen_minutes||0)/60)}),e.jsx("td",{className:"py-2.5 text-right text-sm font-semibold text-emerald-400",children:w(t.ca_genere)})]},s))})]})}):e.jsx(h,{text:"Aucune donnée"})})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-sm font-semibold text-slate-400 uppercase tracking-wider mb-4",children:"Top clients fidèles"}),e.jsx(p,{title:"Top 10 clients par nombre de réparations",children:V.length?e.jsx("div",{className:"overflow-x-auto -mx-5 px-5",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-700",children:[e.jsx("th",{className:"text-left text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"#"}),e.jsx("th",{className:"text-left text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Client"}),e.jsx("th",{className:"text-left text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Téléphone"}),e.jsx("th",{className:"text-center text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"Réparations"}),e.jsx("th",{className:"text-right text-[10px] font-semibold text-slate-500 uppercase tracking-wider py-2",children:"CA total"})]})}),e.jsx("tbody",{children:V.map((t,s)=>e.jsxs("tr",{className:"border-b border-slate-700/30 hover:bg-slate-700/20 transition-colors",children:[e.jsx("td",{className:"py-2.5 text-sm text-slate-500 font-medium",children:s+1}),e.jsx("td",{className:"py-2.5",children:e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg bg-blue-500/20 flex items-center justify-center",children:e.jsx(Te,{className:"w-3.5 h-3.5 text-blue-400"})}),e.jsx("span",{className:"text-sm font-medium text-white",children:t.nom})]})}),e.jsx("td",{className:"py-2.5",children:e.jsxs("span",{className:"flex items-center gap-1.5 text-sm text-slate-400",children:[e.jsx(ze,{className:"w-3 h-3"})," ",t.tel||"—"]})}),e.jsx("td",{className:"py-2.5 text-center",children:e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-violet-500/20 text-violet-300",children:t.nb_reparations})}),e.jsx("td",{className:"py-2.5 text-right text-sm font-semibold text-emerald-400",children:w(t.ca_total)})]},s))})]})}):e.jsx(h,{text:"Aucun client récurrent"})})]}),e.jsx("div",{className:"pt-4 pb-8 text-center",children:e.jsx("p",{className:"text-xs text-slate-600",children:"Klikphone SAV — Panneau d'administration"})})]})]})}function Ye(){const[a,l]=r.useState(()=>{try{const i=localStorage.getItem($);return i?JSON.parse(i):null}catch{return null}});return a?e.jsx(He,{onLogout:()=>{localStorage.removeItem($),l(null)}}):e.jsx(qe,{onLogin:i=>l(i)})}export{Ye as default};
